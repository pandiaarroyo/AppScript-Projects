function resaltarClientes() {
  const hoja = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  if (hoja.getName() !== "COPY PASTE") return;

  const columnaC = hoja.getRange("C:C").getDisplayValues();

  let ultimaFilaC = 0;
  for (let i = columnaC.length - 1; i >= 1; i--) {
    if (columnaC[i][0].toString().trim() !== "") {
      ultimaFilaC = i + 1;
      break;
    }
  }
  if (ultimaFilaC < 2) return;

  const rango = hoja.getRange("C2:C" + ultimaFilaC);
  const valores = rango.getDisplayValues();

  // Listas normalizadas
  const clientesVerde = [
    "AGRICOLA CHALLAPAMPA S.A.C.",
    "AGRICOLA LOS BUENOS MUCHACHOS DE PISCO S.A.C.",
    "AGRICOLA PAMPA BAJA S.A.C.",
    "AGRICOLA PROCOM S.A.C.",
    "AGRICOLA SANTA AZUL S.R.L",
    "AGRICOLA SUNFIELDS S.A.C.",
    "AGROALTO S.A.C.",
    "AGRICOLA INTERANDINA S.A.C.",
    "ALBA CITRUS E.I.R.L.",
    "AGROINDUSTRIAS BARR S.A.C.",
    "LATAM TRADE S.A.C.",
    "WESTFALIA FRUIT PERÚ S.A.C.",
    "J Y T SUPPLIES S.A.C.",
    "DISTRIBUIDORA LATINOANDINA S.A.C.",
    "COMPLEJO AGROINDUSTRIAL BETA S.A.",
    "AGRIFRESH S.A.C.",
    "AGRO ISM S.A.C.",
    "FRESH VEGGIES S.A.C.",
    "JALHUCA AMAZONIA S.A.C.",
    "BERRYCO S.A.C.",
    "ARA EXPORT S.A.C",
    "AGRICOLA SANTA AZUL SRL",
    "MANUELITA FYH S.A.C.",
    "FRESH DEVELOPMENTS S.A.C.",
    "CORPORACION AGROEXPORTICA S.A.C.",
    "AGROINCA PRODUCTOS PERUANOS DE EXP. S.A.",
    "FUKUDA LENCI CARLOS YOSHIO",
    "FAIR FRUIT PERU S.A.C.",
    "GREEN VEGETABLES & FLOWERS S.A.C.",
    "AGROINDUSTRIAS AIB S.A",
    "GLOBAL TRADE FRUT PERU SOCIEDAD COMERCIAL DE RESPONSABILIDAD LIMITADA",
    "NUFIELD S.A.C",
    "HUARAL FRUIT EXPORT S.A.C.",
    "VIRÚ GROUP PERÚ S.A.",
    "REITER PERUVIAN BERRY S.A.",
    "GREEN GOLD PACIFIC S.A.C.",
    "AGRICOLA CHAPI S.A.",
    "SOCIEDAD AGRICOLA DROKASA S.A.",
    "ALBA CITRUS E.I.R.L.",
    "AGRO INDUSTRIA SAN ANTONIO S R LTDA",
    "ALCOAXARQUIA PERU S.A.C.",
    "EXPLORACIONES & LOGISTICA MINERAS S.A.C.",
    "ARONA TRADING S.A.",
    "MUEDAS DE LA CRUZ FREDDY",
    "CC TROPICALES S.A.C.",
    "AGROINDUSTRIA CAMPO VERDE S.A.C.",
    "PERUVIAN PATIÑO W & G S.A.C.",
    "ESTRATEGICAS COMPANY E.I.R.L.",
    "AGROINDUSTRIA GUZMAN & NUÑEZ S.A.C.",
    "AGROVED FRUIT S.A.C.",
    "AMARA FOODS E.I.R.L.",
    "CORPORACION FRUTICOLA DE CHINCHA S.A.C.",
    "ALPA SWEET E.I.R.L.",
    "AÑAY PERUVIAN FRUITS S.A.C.",
    "ASESORIAS E INVERSIONES MUVA S.A.C.",
    "AGRICOLA BGS S.A.C.",
    "ASOCIACION DE PRODUCTORES AGROINDUSTRIALES KALLPA-APAGRO",
    "BLUE PACIFIC OILS S.A.C.",
    "BOARDER LOGISTICS S.A.",
    "CONSORCIO DE PRODUCTORES DE FRUTA S.A.",
    "CORPORACION AGRO LATAM EXPORT S.A.C.",
    "CULTIVEMOS S.A.C.",
    "EMPRESA CAMYMAR E.I.R.L",
    "EUROFRESH PERU S.A.C",
    "FRESH & READY HARVESTS SOCIEDAD ANONIMA",
    "FRUTICAL S.A.C.",
    "FRUTRANSPORT S.A.",
    "GAIA FRUITS S.A.C.",
    "GBZ FOODS S.A.C.",
    "SUN FRUITS EXPORTS S.A.",
    "GENETICA AGRICOLA S.A.C.",
    "HIGHLAND FOODS S.A.C.",
    "AGROINDUSTRIAS KON SOL S.A.C.",
    "INCAVO S.A.C.",
    "GESTION EMPRESARIAL & LOGISTICA S.A.C.",
    "AGROINPER FOODS S.A.C.",
    "INDUSTRIAS SISA S.A.C.",
    "INKA FRESH-LIFE E.I.R.L.",
    "PESQUERA EXALMAR S.A.A.",
    "GBP GROUP S.A.C.",
    "LA FAMILIA SPECIAL S.R.L.",
    "LARAMA BERRIES S.A.C.",
    "M & H FOODS S.A.C.",
    "MEBOL GF S.A.C.",
    "MEBOL S.A.C.",
    "MULTIPRODUCTOS GLOBALES - ANDINOS S.A.C",
    "NAMASKAR S.A.C.",
    "WAMBRA CORP S.A.C.",
    "NATURE AGRICULTURE INVESMENT S.A.C",
    "NAYTANA FRESH S.A.C",
    "SOCIEDAD AGRICOLA ARONA S.A.",
    "NEGOCIOS AGRICOLAS SUR NORTE S.A.C.",
    "FRUTOS Y GRANOS ANDINOS SUMAQ S.A.C.",
    "SEACORP PERU S.A.C.",
    "NOVOLIZ S.A.",
    "PEAK QUALITY DEL PERU S.A",
    "SIEMBRA ALTA S.A.C.",
    "PROCESADORA LARAN S.A.C.",
    "INTIPA FOODS S.A.C.",
    "QORI FOODS S.A.C.",
    "RURU MISHKI S.A.C.",
    "INKA SELECT FRUIT S.A.C.",
    "FAEX TRADING S.A.C.",
    "POLAR FRUIT INTERNATIONAL S.A.C.",
    "CORPORACION AGROLATINA S.A.C.",
    "RVR AGRO S.R.L",
    "EXPORTADORA FRUTICOLA DEL SUR SA",
    "AGRICOLA SANTA AZUL S.A.C.",
    "MARAND COMPANY S.A.C.",
    "TIERRA SOLIDA S.A.C.",
    "SUNRISE DEL PERU E.I.R.L.",
    "KIMSA FRESH E.I.R.L.",
    "FRG FARMS S.A.C.",
    "SK ORGANICS FRUITS S.A.C.",
    "SOCIEDAD AGRICOLA ARONA SA",
    "BUENAVENTURA SOCIEDAD ANONIMA CERRADA",
    "PRESTIGE AVOCADOS S.A.C.",
    "QALI FRUITS S.A.C.",
    "AGROEXPORT FRUITS PERU S.A.C.",
    "FLORIDABLANCA S.A.C.",
    "PHARTEC PRODUCE S.A.C.",
    "COEXA S.A.",
    "CAMPO FRUIT S.A.C.",
    "SOCIEDAD AGRICOLA DON LUIS S.A.",
    "POMICA PERU S.A.C.",
    "SUMAQAO S.A.C.",
    "PEAK QUALITY DEL PERU S.A.",
    "SUN FRUITS PACKS S.A.",
    "SUSTAINABLE INNOVATION FRUIT FARM S.A",
    "SUTRIMEX PERU S.A.C.",
    "AGROEMPAQUES S.A.",
    "TA EXPORT S.A.C.",
    "VICTORIA AGROEXPORTACIONES S.A.C."
    ].map(x => x.toUpperCase()); // Reemplaza [...] con tu lista
  const clientesMorado = [
    "AGRICOLA BLUE GOLD S.A.C.",
    "AGRICOLA CERRO PRIETO S.A.",
    "AGRICOLA TAYCA S.A.C.",
    "AGROBERRIES PERU S.A.C.",
    "AGROCASAGRANDE S.A.C.",
    "AGROINDUSTRIAL ESTANISLAO DEL CHIMU S.A.C.",
    "AVOGLOBE E.I.R.L.",
    "AGROVISION PERU S.A.C.",
    "FRUGLOBE S.A.C.",
    "EXPORTADORA EL PARQUE PERU S.A.C.",
    "AGROFUTURA COMPANY S.A.C.",
    "TWF S.A.",
    "DOMINUS S.A.C",
    "TOTAL FRUIT PERU S.A.C.",
    "SANTA SOFIA DEL SUR S.A.C.",
    "PEPAS TROPICALES DEL PERU S.A.C.",
    "GREEN PERU S.A",
    "INKA'S BERRIES S.A.C.",
    "AGUALIMA S.A.C.",
    "VIRU S.A.",
    "AQU ANQA II S.A.C.",
    "INKA´S BERRIES S.A.C.",
    "AGRICOLA HUARMEY S.A.C.",
    "INDUSTRIAL PESQUERA SANTA MONICA S.A.",
    "AQU ANQA S.A.C.",
    "BIG BERRIES S.A.C.",
    "BOMAREA S.R.L.",
    "AGROEXPORTACIONES NATHANAEL S.A.C.",
    "JALHUCA PERÚ S.A.C.",
    "CANYON BERRIES S.A.C.",
    "ARA FOODS INDUSTRY S.A.C.",
    "DESARROLLO FRUTICOLA SUDAMERICANA S.A.C.",
    "AGRO QORIANKA S.A.C.",
    "ECOSAC AGRICOLA S.A.C.",
    "AGROSANJACINTO S.A.C.",
    "EXCELLENCE FRUIT S.A.C",
    "GAP BERRIES S.A.C.",
    "GIDDINGS BERRIES PERU S.A.C.",
    "GMH BERRIES S.A.C.",
    "AGRICOLA Y GANADERA CHAVIN DE HUANTAR S.A.",
    "HASS PERU S.A.",
    "ITABEN EXPOPERU S.A.C.",
    "MANGOES EXPORT PERU S.A.C.",
    "PURA BERRIES S.A.C.",
    "SAN EFISIO S.A.C."
    ].map(x => x.toUpperCase());
  const clientesRojo = [
    "AGRICOLA ANDREA S.A.C.",
    "AGRICOLA MULTI EXPORT IMPORT S.A.C",
    "AGRO KION S.A.C.",
    "HORTIFRUT - PERÚ S.A.C.",
    "MEDLOG PIURA SAC",
    "DOM PORQUITO AGROINDUSTRIALS.A",
    "IMPORT EXPORT ACUZA S.A.C.",
    "LA HANSEATICA S.A.",
    "LOGISTICA SUARDIAZ PERU SOCIEDAD ANONIMA",
    "FCP LOGISTICS CORPORATION S.R.L.",
    "CG2 TRANSPORTES Y ASESORIA E.I.R.L.",
    "LOGISTIC SOLUTIONS GLOBAL SAC",
    "PLANASA PERU S.A.C.",
    "HAI TRADE S.A.C.",
    "SICHER CARGO PERU S.A.C.",
    "CO LOGISTIC PERU S.A.C.",
    "IMPALA TERMINALS PERU S.A.C.",
    "TALSA AGROEXPORT S.A.C.",
    "EL ROCIO S.A.",
    "TAL S.A. DLG TRANSPORT S.A.C.",
    "TAL S.A. NEW TRANSPORT S.A.",
    "CS LOGISTICS S.A.C.",
    "TAL S.A. TRANSLOGISTICS S.A.C",
    "ANDES LOGISTICS DEL PERU S.A.C.",
    "DATISA FORWARDERS PERU S.A.C.",
    "TAL S.A. SPECIALIZED REEFER LOGISTICS S.A.C.",
    "KUEHNE NAGEL S.A.",
    "DSV AIR & SEA S.A.",
    "TAL S.A. DATISA FORWARDERS PERU S.A.C.",
    "TAL S.A. ADUANERA CAPRICORNIO S.A AG DE ADUANA",
    "DANPER TRUJILLO S.A.C.",
    "AGROINCA PRODUCTOS PERUANOS DE EXP. SA",
    "AGROINDUSTRIAL HUAMANI S.A.C.",
    "JCEP LOGISTIC E.I.R.L.",
    "ALEXIM PERU S.R.L.",
    "MIGIVA S.A.C.",
    "TERMINALES PORTUARIOS PERUANOS S.A.C.",
    "A.HARTRODT PERU S.A.C.",
    "AGROINDUSTRIAS JOSE LUIS SAC",
    "PORT LOGISTICS S.A.C.",
    "AGRICOLA DON RICARDO S.A.C.",
    "CAMPOSOL S.A.",
    "AGRONUTRICION PERU S.A.C.",
    "LOGISTICS SOLUTIONS RM SOCIEDAD ANONIMA CERRADA",
    "MAC TRANSPORT S.A.C.",
    "COSCO SHIPPING PORTS CHANCAY PERU S.A.",
    "GF LOGISTICS PERU S.A.C.",
    "ACUACULTURA Y PESCA S.A.C",
    "SCHARFF LOGISTICA INTEGRADA S.A.",
    "CAPITAN FLINT S.A.C.",
    "KEY TRANSPORT GROUP S.A.C.",
    "FLEXCARGO E.I.R.L.",
    "AGENCIAS UNIVERSALES PERU S.A.",
    "AGROBUSINESS INTERNATIONAL PERU S.A.C.",
    "KX SUPPORT LINE S.A.C.",
    "BECA GLOBAL LOGISTICS S.A.C.",
    "AGRONUTRICION PERU SAC",
    "CMA OPERADOR INTEGRAL S.A.C.",
    "ANTICONA S.A.C.",
    "THE LOGISTIC SILVER PREMIUM S.A.C.",
    "TRANSPORTES Y SERVICIOS MGR S.A.C.",
    "CMA CGM PERU S.A.C.",
    "ULOG PERU S.A.",
    "SPRINTER ASESORES LOGISTICOS SOCIEDAD ANONIMA CERRADA",
    "CHAVIN DRIED S.A.C.",
    "AGENCIA DE ADUANA AMT S.A.C.",
    "G.W. YICHANG & CIA S.A.",
    "ZGROUP S.A.C.",
    "RANSA COMERCIAL S.A.C.",
    "CLP OPERADOR LOGISTICO S.A.C",
    "DPW LOGISTIC S.A.C.",
    "DROCERSA S.A. - DROCERSA",
    "EXPEDITORS PERU S.A.C.",
    "FAVORITE FRUIT S.A.C.",
    "FRUTAS MITPAL S.A.C.",
    "FRUTISAMA S.A.C.",
    "GALIA EXPORT S.A.C.",
    "GRUPO TREBOL S.A.C.",
    "IMEX GROUP AMERICAS S.A.C.",
    "JAVIER LUND OJEDA",
    "LIP ADUANAS S.A.",
    "LOS OLIVOS DE VILLACURI S.A.C.",
    "LUNA VERDE SOCIEDAD ANONIMA CERRADA",
    "MACKJAL & AGROINDUSTRIA E.I.R.L.",
    "MELKOR S.A.C.",
    "OREGON FOODS S.A.C.",
    "PACIFIC SUN FARMS DEL PERU S.A.C.",
    "PERUVIAN INKA FRUIT S.A.C.",
    "PRICER PERU S.A.C.",
    "PTC S.A.C",
    "SERVICIOS GENERALES Y AGROPECUARIOS D'RUFFINO S.A.C",
    "STERLING PERU S.A.C."
    ].map(x => x.toUpperCase());
  const clientesAmarillo = [
    "A & M LEXA EXPORT S.A.C.",
    "AGP S.A.C",
    "AGRICOLA DON RICARDO S.A.C",
    "CORPORACION AGROLATINA S.A.C",
    "AGRICOLA JAPURIMA S.A.",
    "PRIMA FRUTA AGRICOLA S.A.C.",
    "AGRICOLA NUESTRA TIERRA S.A.C.",
    "AGRICOLA PALTO DEL CENTRO S.A.C.",
    "AGROEXPORTACIONES ALBATROS S.A.C.",
    "SUNSHINE EXPORT S.A.C.",
    "AGROSERVICIOS PENTA S.A.C.",
    "AMELSA S.A.",
    "AMUNATEGUI, JAVIER ALONSO",
    "APM TERMINALS CALLAO S.A.C.",
    "AVANTEX SAC",
    "BENCHMARK INTERNATIONAL PERU S.A.C.",
    "C & C CORPORATION S.A.C.",
    "ALTIM GREEN S.A.C.",
    "CERVEZAS SAN JUAN S.A.C.",
    "CIPLA S.A.C.",
    "COMERCIAL GUERRERO S.A.C.",
    "CORPORACION INTEGRAL FRUITS S.A.C.",
    "DELTA PERU S.A.C.",
    "DIALIMED PERU S.A.C.",
    "DISTRIBUIDORA ZETA S.A.C.",
    "ELECTROCOMERCIAL TRANSFER S.A.C.",
    "EXPORTADORA FRUTICOLA DEL SUR S.A.C.",
    "FRESH START PRODUCTS S.A.C.",
    "GRUPO AGRICOLA DEL CENTRO S.A.C.",
    "GRUPO INCA S.A.C.",
    "GRUPO LAS LOMAS S.A.C.",
    "IMPORTADORA Y EXPORTADORA ESPEJO S.A.C.",
    "INDUSTRIA ALIMENTICIA DE AGUAYTIA S.A.C.",
    "INDUSTRIA DE PESCA ANNUAL S.A.C.",
    "J W DEL PERU S.A.C.",
    "JIMENEZ SANTOS ALONSO",
    "JUNIOR BERRY S.A.C.",
    "K-1 PERU S.A.C.",
    "KAMPAI S.A.C.",
    "KINGLAND IMPORT & EXPORT S.A.C.",
    "LABORATORIO FABRIL PERU S.A.C.",
    "LOS GRANADOS S.A.C.",
    "MEDITERRANEA EXPORTACIONES S.A.C.",
    "MERCADOS & LOGISTICA S.A.C.",
    "MINERA PERU S.A.C.",
    "MOLINO SAN FRANCISCO S.A.C.",
    "MULTIPRODUCTOS INDUSTRIALES JARE SAC",
    "NEVADO S.A.C.",
    "OCEANAGOLD PERU S.A.C.",
    "OLIMPICA S.A.C.",
    "PEMEXA S.A.C.",
    "PROMPERU",
    "PROMOTORA AGRO INDUSTRIAL AMANECER S.A.C.",
    "PROMPERU PROMOTUR",
    "PROVEEDORA AGROINDUSTRIAL AMANECER S.A.C.",
    "ROYAL FRUITS S.A.C.",
    "PROCESADORA DEL SUR S.A.",
    "SAN MARTIN FRUIT S.A.C.",
    "COMERCIAL NIVAMA S.A.C.",
    "SANDOVAL DEL PERU S.A.C.",
    "SENPA PERU S.A.C.",
    "SOCIEDAD AGRICOLA DON LUIS S.A.",
    "SOCIEDAD AGRICOLA LOS ANDES S.A.C.",
    "SPS S.A.C.",
    "SUNRISE TRADING S.A.C.",
    "TAMARA SAC",
    "TERESA GOMEZ Y ASOCIADOS S.A.C.",
    "TORRE INDUSTRIAS S.A.",
    "TRANSPORTES CHAVIN S.A.C.",
    "UNIVERSAL CARGO LOGISTICA S.A.C.",
    "UNIVERSAL LOGISTICA S.A.C.",
    "VIMAR EXPORT S.A.C.",
    "VIVERES & DELI S.A.C.",
    "WILMAR PERU S.A.C."
    ].map(x => x.toUpperCase());

  const colores = [];
  const prioridades = []; // columna Z para ordenar por color

  for (let i = 0; i < valores.length; i++) {
    const valor = valores[i][0].toString().trim().toUpperCase();

    if (valor === "") {
      colores.push(["#ffffff"]);
      prioridades.push(["5"]); // vacíos van al final
    } else if (clientesVerde.includes(valor)) {
      colores.push(["#c6efce"]);
      prioridades.push(["1"]);
    } else if (clientesMorado.includes(valor)) {
      colores.push(["#e4d5f3"]);
      prioridades.push(["2"]);
    } else if (clientesRojo.includes(valor)) {
      colores.push(["#f4cccc"]);
      prioridades.push(["3"]);
    } else if (clientesAmarillo.includes(valor)) {
      colores.push(["#fff2cc"]);
      prioridades.push(["4"]);
    } else {
      colores.push(["#ffffff"]);
      prioridades.push(["5"]);
    }
  }

  rango.setBackgrounds(colores);

  // Insertar valores auxiliares en columna Z
  const rangoPrioridad = hoja.getRange(2, 26, prioridades.length, 1); // Columna Z = 26
  rangoPrioridad.setValues(prioridades);

  // Ordenar por columna Z (prioridades de color)
  hoja.getRange(2, 1, ultimaFilaC - 1, hoja.getLastColumn()).sort({column: 26, ascending: true});

  // Limpiar columna Z
  rangoPrioridad.clearContent();
}
